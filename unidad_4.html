<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Unidad 4 - Nivel de Red - Apunte Final Teoria de las Comunicaciones 2024</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./custom.css">
        <link rel="stylesheet" href="./mdbook-admonish.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="unidad_0.html"><strong aria-hidden="true">1.</strong> Unidad 0 - Introducción, conceptos básicos</a></li><li class="chapter-item expanded "><a href="unidad_1.html"><strong aria-hidden="true">2.</strong> Unidad 1 - Nivel físico</a></li><li class="chapter-item expanded "><a href="unidad_2.html"><strong aria-hidden="true">3.</strong> Unidad 2 - Nivel de Enlace</a></li><li class="chapter-item expanded "><a href="unidad_3.html"><strong aria-hidden="true">4.</strong> Unidad 3 - Medios Compartidos</a></li><li class="chapter-item expanded "><a href="unidad_4.html" class="active"><strong aria-hidden="true">5.</strong> Unidad 4 - Nivel de Red</a></li><li class="chapter-item expanded "><a href="unidad_5.html"><strong aria-hidden="true">6.</strong> Unidad 5 - Ruteo</a></li><li class="chapter-item expanded "><a href="unidad_6.html"><strong aria-hidden="true">7.</strong> Unidad 6 - Nivel de Transporte</a></li><li class="chapter-item expanded "><a href="unidad_7.html"><strong aria-hidden="true">8.</strong> Unidad 7 - El problema de Congestión</a></li><li class="chapter-item expanded "><a href="unidad_8.html"><strong aria-hidden="true">9.</strong> Unidad 8 - Nivel de Aplicación</a></li><li class="chapter-item expanded "><a href="unidad_9.html"><strong aria-hidden="true">10.</strong> Unidad 9 - Seguridad</a></li><li class="chapter-item expanded "><a href="bibliografia.html"><strong aria-hidden="true">11.</strong> Bibliografía</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Apunte Final Teoria de las Comunicaciones 2024</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="unidad-4---nivel-de-red"><a class="header" href="#unidad-4---nivel-de-red">Unidad 4 - Nivel de Red</a></h1>
<p><img src="./img/osi_isp.png#center" alt="" /></p>
<p>Retomando el modelo OSI, podemos ver que de capa 3 para abajo tenemos lo que se
llama el <strong>límite de subred de comunicación</strong>, que delimita las capas sobre las
que operan los isp.</p>
<h2 id="redes-escalables-con-switches"><a class="header" href="#redes-escalables-con-switches">Redes escalables... con switches</a></h2>
<p>Peterson afirma que internet es una red <strong>escalable</strong>. Por escalable vamos a
entender como aquello que cuando crece, el costo de su
mantenimiento/administración es mínimo. Internet no solo es escalable, es
<strong>altamente escalable</strong>.</p>
<p>Cómo se logra eso? Principalmente mediante <strong>routers/switches</strong>. Su objetivo
principal es conmutar o forwardear paquetes. Dependiendo el tipo de switch, van
a distribuir paquetes mediante:</p>
<ul>
<li><strong>circuitos virtuales</strong></li>
<li><strong>conmutación de datagramas</strong></li>
</ul>
<p>Notar que ambos pertenecen al paradigma de conmutación de paquetes, pero
también existe lo que antes se usaba que era la conmutación de circuitos.</p>
<h3 id="conmutación-de-paquetes"><a class="header" href="#conmutación-de-paquetes">Conmutación de paquetes</a></h3>
<p>Tenemos 2 paradigmas (que usan una u otra forma de distribuir paquetes):</p>
<ul>
<li>Orientado a conexión (circuitos virtuales): acá también mando varios
paquetes, pero el camino es fijo. <img src="./img/virtual_circuits.png" alt="" />
<ul>
<li>necesito "alguna magia" que arme toda la ruta</li>
<li>le decimos "orientado a conexión" porque previamente establezco una
comunicación entre ambos hosts.</li>
<li>tengo 3 fases:
<ul>
<li>establecer conexión</li>
<li>mandar datos</li>
<li>levantar la conexión</li>
</ul>
</li>
<li>llegan en orden</li>
</ul>
</li>
<li>Sin conexión (datagramas IP): parto la info a mandar en datagramas (cachitos
de info) y la mando, cada uno puede tomar una ruta a destino distinta y
podrían llegar desordenados. <img src="./img/datagrams.png" alt="" />
<ul>
<li><strong>no existe una fase para establecer una conexión</strong></li>
<li>como cada paquete se envía de forma independiente, tiene que ser
autosuficiente. O sea necesita dir fuente y dir destino (cof cof IP)</li>
</ul>
</li>
</ul>
<p>Si bien circuitos virtuales estaba medio muerto, con la tecnología 5G tuvo un
renacimiento, aunque se lo llama <strong>slicing</strong></p>
<h4 id="conmutación-sin-conexión"><a class="header" href="#conmutación-sin-conexión">Conmutación sin conexión</a></h4>
<ul>
<li>cada switch mantiene una tabla de forwarding
<ul>
<li>uso un <strong>algoritmo de ruteo</strong> para armarla</li>
</ul>
</li>
<li>la tabla me dice a dónde mandar un paquete en base a la dirección destino.</li>
<li>tuvo que haber un algoritmo de seteo inicial para armar esas tablas</li>
</ul>
<p><img src="./img/datagram_routing_scheme.png" alt="" /></p>
<h4 id="conmutación-orientada-a-conexión--circuitos-virtuales"><a class="header" href="#conmutación-orientada-a-conexión--circuitos-virtuales">Conmutación orientada a conexión / Circuitos virtuales</a></h4>
<ul>
<li>al igual que datagramas se arma una tabla pero una <strong>tabla de circuitos
virtuales</strong> (no vamos a estudiar cómo). La misma tiene:
<ul>
<li>Puerto por donde llega un paquete</li>
<li>VCI (id del circuito) de entrada</li>
<li>puerto de salida del paquete</li>
<li>id del VCI de salida</li>
</ul>
</li>
<li>cómo armo la tabla de circuitos? cómo armo los VCI?</li>
<li>cómo sé dónde está cada nodo?</li>
<li>Tengo 2 tipos:
<ul>
<li>permanente (la define el administrador)
<ul>
<li>se tiene que configurar y recién ahí puedo proceder a mandar datos</li>
</ul>
</li>
<li>por solicitud o conmutado
<ul>
<li>se mandan mensajes de solicitud de conexión a la red</li>
<li>se arma una cadena de switches que llevan hasta el host destino que
tienen que aceptar la conexión y propagar la solicitud al siguiente
switch / nodo.</li>
<li>una vez construido el circuito virtual se empiezan a enviar datos</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Cuál sería algún incentivo para preferir circuitos virtuales? Al establecer la
conexión uno puede "reservar" recursos (léase ancho de banda, buffers, etc.)
puedo garantizar cierta calidad de servicio y mejor control de congestión.</p>
<h4 id="modelo-de-datagrama-vs-circuitos"><a class="header" href="#modelo-de-datagrama-vs-circuitos">Modelo de Datagrama vs Circuitos</a></h4>
<p>Datagrama:</p>
<ul>
<li>No hace falta esperar a un RTT para establecer una conexión</li>
<li>Inmediatamente disponible para mandar datos</li>
<li>Envío paquete sin establecer conexión</li>
<li>Estadísticamente los datagramas llegan en orden</li>
<li>Hago mi mejor esfuerzo para rutear el paquete en la red</li>
</ul>
<p>Circuitos Virtuales:</p>
<ul>
<li>Necesito fase inicial para establecer una conexión y una final para
liberarla, que no transportan datos del usuario
<ul>
<li>tengo algo de overhead</li>
</ul>
</li>
<li>Una vez establecido el circuito se usa siempre eso para mandar (no es adaptable a fallas/congestión)</li>
</ul>
<p>Ahora, una vez establecida la conexión los circuitos virtuales funcionan mucho
mejor. Por qué entonces ganó datagramas.</p>
<ul>
<li>Circuitos virtuales requería más infraestructura del lado del ISP
<ul>
<li>Eso también permitía ser más exigentes con el costo del servicio (ej: te
cobro por cada paquete transmitido)</li>
<li>Al ser más complejo es también menos escalable</li>
</ul>
</li>
<li>Si bien con datagramas la comunicación es "boba", eventualmente se armaron
protocolos que permiten resolver algunos de los problemas que circuitos
virtuales resolvía mediante infra, pero con software (esa solución es la que
conocemos como TCP).</li>
</ul>
<div id="admonition-conmutación-de-circuitos-vs-conmutación-de-paquetes" class="admonition admonish-note">
<div class="admonition-title">
<p>Conmutación de circuitos vs. Conmutación de paquetes</p>
<p><a class="admonition-anchor-link" href="#admonition-conmutación-de-circuitos-vs-conmutación-de-paquetes"></a></p>
</div>
<div>
<p>Algo en lo que se hizo mucho incapié es en el hecho de que podemos llegar a
confundir circuitos virtuales con conmutación de circuitos, y que por ende
ambos operan en capas 1, 2 y 3. Sin embargo, recordemos que conmutación de
circuitos refiere a lo visto para la unidad 0 y aplica únicamente a capa 1
(física).</p>
</div>
</div>
<h3 id="ip-en-internet"><a class="header" href="#ip-en-internet">IP en Internet</a></h3>
<ul>
<li>Permito interconexión de redes</li>
<li>A priori puedo tener distintos tipos de conexiones a lo largo del camino que
toma el paquete, pero el "glue code" viene a ser ip: <img src="./img/ip_stack.png" alt="" /></li>
<li>IP <strong>ES SENCILLO</strong>
<ul>
<li>El formato fundamentalmente es agregar dos campos, hay más cosas pero el
core son los campos de dirección fuente y destino</li>
</ul>
</li>
</ul>
<h3 id="campos-del-header-ip-versión-4"><a class="header" href="#campos-del-header-ip-versión-4">Campos del header IP (versión 4)</a></h3>
<ul>
<li>Header de 20bytes con 40 bytes extra para campos opcionales</li>
<li>Los campos
<ul>
<li><em>Versión</em>: para tener versiones coexistiendo</li>
<li><em>Longitud del header</em>: ya que puede crecer por los opcionales</li>
<li><em>DiffServ/ECN</em>: permite dar prioridad a cierto tráfico (ej: puedo
configurar los routers de mi red para que prioricen al ECN específico)</li>
<li><em>Longitud total</em>: en bytes e incluyendo el header</li>
<li><em>Fragmentación</em>: Ta compuesto por varios sub-campos: Identificación, bit
de No fragmentar (DF), bit de más fragmentar (MF) y un bit de
desplazamiento.
<ul>
<li>No todas las tecnologías de acceso al medio tiene el mismo tamaño de
trama. Entonces IP necesita un mecanismo de fragmentación para pasar
por distintos tipos de redes con distintas tecnologías de acceso al
medio.</li>
</ul>
</li>
<li><em>TTL</em>: es un contador que se decrementa con cada salto entre routers. Si
llega a 0 se descarta el paquete.</li>
<li><em>Checksum</em>: sólo del header, no de los datos (TCP es el único que hace
correción de errores)</li>
<li><em>Dirección fuente y destino</em>: de 32 bits</li>
<li><em>Protocolo</em>: un identificador que le permite al router saber qué lleva el paquete IP
<img src="./img/ip_protocol_field.png" alt="" /></li>
</ul>
</li>
</ul>
<h4 id="fragmentación-y-re-ensamblado"><a class="header" href="#fragmentación-y-re-ensamblado">Fragmentación y re-ensamblado</a></h4>
<ul>
<li>Cada tecnología de acceso al medio tiene (a nivel de enlace), un <strong>MTU</strong>
(Maximum Transmission Unit)
<ul>
<li>ej: en Ethernet son 1500 bytes, en FDDI 4500 bytes</li>
</ul>
</li>
<li>Entonces, IP se adapta a la tecnología de enlace
<ul>
<li>Si recibo un datagrama y MTU &lt; |Datagrama|, lo tengo que partir en
fragmentos o <strong>fragmentar</strong> y el host destino los <strong>reensabla</strong></li>
<li>Los fragmentos llevan un identificador cosa de saber cuáles corresponden
a un mismo datagrama</li>
<li>Además contienen:
<ul>
<li>un offset para poder ordenarlos</li>
<li>un bit para marcar el último fragmento</li>
</ul>
</li>
</ul>
</li>
<li>Hoy en día, estadísticamente, la fragmentación es mínima (si tenés mucha
fragmentación puede que te estén hackeando).</li>
</ul>
<h3 id="direccionamiento-global"><a class="header" href="#direccionamiento-global">Direccionamiento Global</a></h3>
<ul>
<li>Se pensó una organización <strong>jerárquica</strong>
<ul>
<li>Una dirección compuesta por red + host</li>
</ul>
</li>
<li>Las direcciones son "globalmente únicas"</li>
<li>Esquema de clases <em>A</em>, <em>B</em> y <em>C</em>
<ul>
<li>las clases más altas pueden tener más hosts</li>
</ul>
</li>
</ul>
<h3 id="forwarding-de-ip"><a class="header" href="#forwarding-de-ip">Forwarding de IP</a></h3>
<p>Cómo hacen los routers para saber a dónde mandar un datagrama?</p>
<ul>
<li>El datagrama recordemos tiene la dirección destino</li>
<li>Si el router está en dicha dirección destino, entonces hace el forward al
host</li>
<li>Si no está conectado directamente a esa red, tiene que hacer un forward a
otro router que lo elige en base a su <strong>tabla de forwarding</strong>
<ul>
<li>mapea una dirección de red al <em>next hop</em></li>
</ul>
</li>
<li>Además cada host tiene un default router</li>
</ul>
<h3 id="ipv6"><a class="header" href="#ipv6">IPV6</a></h3>
<ul>
<li>Se definió en la década del 90'.</li>
<li>El número de dispositivos totales que soportaba IPv4 admitía ~4300 millones de direcciones.</li>
<li>En su momento no se pensaba que ibamos a quedarnos sin direcciones pero hoy en día ya es una realidad.</li>
<li>Usa 128 bits de direccionamiento en lugar de sólo 32 bits</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="unidad_3.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="unidad_5.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="unidad_3.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="unidad_5.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
